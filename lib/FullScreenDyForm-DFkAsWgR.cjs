"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),C=require("./index-D15YARE8.cjs"),V=require("./index-BuiBLsLS.cjs"),F={key:0,class:"btns"},P=e.defineComponent({__name:"FullScreenDyForm",props:{schema:{},showBtns:{type:[Object,Boolean]},init:{},onCancel:{type:Function},allowDirectClose:{type:Boolean},onSubmit:{type:Function},style:{},draggable:{type:Boolean},title:{},fadeInOut:{type:Boolean},fadeTime:{},mousePosition:{},goClose:{},customBtns:{},showCloseBtn:{type:Boolean},onModalClick:{type:Function}},setup(x){const y=e.defineAsyncComponent(()=>Promise.resolve().then(()=>require("./index-D15YARE8.cjs")).then(o=>o.index)),p=e.ref(),k=o=>{p.value=o},t=x,a=e.ref({}),u=e.ref(!1),m=e.ref(t.schema);e.onMounted(()=>{Object.keys(t.init).length>0&&(a.value={...t.init}),t.title&&(m.value.title=t.title)});const w=()=>{t.allowDirectClose?t.onCancel():V.Modal.confirm({title:"确认关闭",content:"关闭后将不会保存当前数据，是否继续？",onOk:()=>{t.onCancel()},okText:"确认关闭",okType:"primary",okButtonProps:{danger:!0},cancelText:"返回",zIndex:1e4,centered:!0})},b=()=>{u.value=!0},E=()=>{u.value=!1},T={mounted(o){if(!t.draggable)return;let n=o;const l=s=>{const i={x:n.getBoundingClientRect().x,y:n.getBoundingClientRect().y},c={x:s.clientX,y:s.clientY},v={width:n.getBoundingClientRect().width,height:n.getBoundingClientRect().height},g=h=>{n.style.cursor="move";const B={x:h.clientX-c.x,y:h.clientY-c.y},r={x:i.x+B.x,y:i.y+B.y};r.x<15||r.y<15||r.x+v.width>window.innerWidth-30||r.y+v.height>window.innerHeight-15||(n.style.left=r.x+"px",n.style.top=r.y+"px")};document.addEventListener("mousemove",g),document.addEventListener("mouseup",()=>{n.style.cursor="default",document.removeEventListener("mousemove",g)})};n.style.position="absolute",n.addEventListener("mousedown",l)},unmounted(o){if(!t.draggable)return;o.removeEventListener("mousedown",()=>{})}};let d=null;const S={mounted(o,n){d=o;const l=n.value;l.enable&&(o.style.opacity="0",setTimeout(()=>{o.style.transition="opacity "+l.fadeTime+"ms ease",o.style.opacity="1"},10))}};let f=null;const O={mounted(o,n){f=o;const l=n.value;if(!l.enable)return;if(o.style.scale="0.2",!t.mousePosition){o.style.transformOrigin="center";return}const s=o.getBoundingClientRect(),i=t.mousePosition.x-s.left,c=t.mousePosition.y-s.top;o.style.transformOrigin=`${i}px ${c}px`,setTimeout(()=>{o.style.transition="scale "+l.fadeTime+"ms ease",o.style.scale="1"})}};e.watch(()=>t.goClose.value,o=>{o&&(d&&(d.style.opacity="0"),f&&(f.style.scale="0.2"))});const M=async()=>{var o,n;return!!await((n=(o=p.value)==null?void 0:o.exposed)==null?void 0:n.validateThenGetModel())||!1};return(o,n)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:"fullscreen",onClick:n[2]||(n[2]=l=>{var s;return(s=t.onModalClick)==null?void 0:s.call(t,{model:a.value,close:()=>t.onCancel(),event:l})})},[e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:"full-form",style:e.normalizeStyle({...t.style}),onClick:n[1]||(n[1]=e.withModifiers(()=>{},["stop"]))},[e.createVNode(C.DynamicForm,{schema:m.value,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=l=>a.value=l),"show-btns":t.showBtns,class:"form","on-before-submit":b,"on-submit":t.onSubmit,"on-after-submit":E,"registe-to-parent":k},null,8,["schema","modelValue","show-btns","on-submit"]),t.showCloseBtn?(e.openBlock(),e.createElementBlock("div",F,[e.createVNode(e.unref(y),{shape:"circle",type:"primary",danger:"",onClick:w,disabled:u.value},{default:e.withCtx(()=>[e.createVNode(e.unref(C.CloseOutlined))]),_:1},8,["disabled"])])):e.createCommentVNode("",!0),t.customBtns&&t.customBtns.length>0?(e.openBlock(),e.createElementBlock("div",{key:1,class:"custombtns",style:e.normalizeStyle({display:"flex",justifyContent:"center",marginTop:"20px",gap:"20px",...m.value.customBtnsStyle})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.customBtns,l=>(e.openBlock(),e.createElementBlock("div",{key:l.text,style:e.normalizeStyle({display:"inline",justifyContent:"center",...l.outterStyle})},[e.createVNode(e.unref(y),e.mergeProps({onClick:s=>{var i;(i=l.onClick)==null||i.call(l,{doCheck:()=>M(),close:()=>t.onCancel(),model:a.value,event:s})},ref_for:!0},l.props,{style:{...l.style}}),{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.text),1)]),_:2},1040,["onClick","style"])],4))),128))],4)):e.createCommentVNode("",!0)],4)),[[T],[O,{fadeTime:t.fadeTime||150,enable:t.fadeInOut||!0}]])])),[[S,{fadeTime:t.fadeTime||150,enable:t.fadeInOut||!0}]])}});exports.default=P;
